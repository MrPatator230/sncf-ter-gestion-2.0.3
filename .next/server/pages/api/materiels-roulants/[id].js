"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/materiels-roulants/[id]";
exports.ids = ["pages/api/materiels-roulants/[id]"];
exports.modules = {

/***/ "mysql2/promise":
/*!*********************************!*\
  !*** external "mysql2/promise" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("mysql2/promise");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmateriels-roulants%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fmateriels-roulants%2F%5Bid%5D.js&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmateriels-roulants%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fmateriels-roulants%2F%5Bid%5D.js&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_materiels_roulants_id_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/materiels-roulants/[id].js */ \"(api)/./pages/api/materiels-roulants/[id].js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_materiels_roulants_id_js__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_materiels_roulants_id_js__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/materiels-roulants/[id]\",\n        pathname: \"/api/materiels-roulants/[id]\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_materiels_roulants_id_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRm1hdGVyaWVscy1yb3VsYW50cyUyRiU1QmlkJTVEJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZtYXRlcmllbHMtcm91bGFudHMlMkYlNUJpZCU1RC5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDRTtBQUMxRDtBQUNtRTtBQUNuRTtBQUNBLGlFQUFlLHdFQUFLLENBQUMsZ0VBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLGdFQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLHlHQUFtQjtBQUNsRDtBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL21hdGVyaWVscy1yb3VsYW50cy9baWRdLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsICdkZWZhdWx0Jyk7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCAnY29uZmlnJyk7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9tYXRlcmllbHMtcm91bGFudHMvW2lkXVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL21hdGVyaWVscy1yb3VsYW50cy9baWRdXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogJycsXG4gICAgICAgIGZpbGVuYW1lOiAnJ1xuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmateriels-roulants%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fmateriels-roulants%2F%5Bid%5D.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/materiels-roulants/[id].js":
/*!**********************************************!*\
  !*** ./pages/api/materiels-roulants/[id].js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _utils_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/db */ \"(api)/./utils/db.js\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nasync function handler(req, res) {\n    const { id } = req.query;\n    if (req.method === 'PUT') {\n        const { name, type, imageData } = req.body;\n        if (!name || !type) {\n            return res.status(400).json({\n                error: 'Name and type are required'\n            });\n        }\n        try {\n            const [existing] = await _utils_db__WEBPACK_IMPORTED_MODULE_0__[\"default\"].query('SELECT image_data FROM materiels_roulants WHERE id = ?', [\n                id\n            ]);\n            let imageUrl = existing.length > 0 ? existing[0].image_data : null;\n            if (imageData) {\n                // A new image is being uploaded\n                try {\n                    const dirPath = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), 'public', 'images', 'materiel-roulant');\n                    if (!fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(dirPath)) {\n                        fs__WEBPACK_IMPORTED_MODULE_1___default().mkdirSync(dirPath, {\n                            recursive: true\n                        });\n                    }\n                    const matches = imageData.match(/^data:image\\/([A-Za-z-+\\/]+);base64,(.+)$/);\n                    if (!matches || matches.length !== 3) {\n                        return res.status(400).json({\n                            error: 'Invalid image data'\n                        });\n                    }\n                    const imageBuffer = Buffer.from(matches[2], 'base64');\n                    const fileExtension = matches[1].split('/')[1] || 'png';\n                    const fileName = `${name.toLowerCase().replace(/\\s+/g, '-')}-${Date.now()}.${fileExtension}`;\n                    const filePath = path__WEBPACK_IMPORTED_MODULE_2___default().join(dirPath, fileName);\n                    fs__WEBPACK_IMPORTED_MODULE_1___default().writeFileSync(filePath, imageBuffer);\n                    // If there was an old image, delete it\n                    if (imageUrl) {\n                        const oldPath = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), 'public', imageUrl);\n                        if (fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(oldPath)) {\n                            fs__WEBPACK_IMPORTED_MODULE_1___default().unlinkSync(oldPath);\n                        }\n                    }\n                    imageUrl = `/images/materiel-roulant/${fileName}`;\n                } catch (error) {\n                    console.error('Error saving image:', error);\n                    return res.status(500).json({\n                        error: 'Failed to save image'\n                    });\n                }\n            }\n            await _utils_db__WEBPACK_IMPORTED_MODULE_0__[\"default\"].query('UPDATE materiels_roulants SET name = ?, type = ?, image_data = ?, updated_at = NOW() WHERE id = ?', [\n                name,\n                type,\n                imageUrl,\n                id\n            ]);\n            const [updatedRows] = await _utils_db__WEBPACK_IMPORTED_MODULE_0__[\"default\"].query('SELECT * FROM materiels_roulants WHERE id = ?', [\n                id\n            ]);\n            res.status(200).json(updatedRows[0]);\n        } catch (error) {\n            console.error('Error updating materiel roulant:', error);\n            res.status(500).json({\n                error: 'Failed to update materiel roulant'\n            });\n        }\n    } else if (req.method === 'DELETE') {\n        try {\n            const [existing] = await _utils_db__WEBPACK_IMPORTED_MODULE_0__[\"default\"].query('SELECT image_data FROM materiels_roulants WHERE id = ?', [\n                id\n            ]);\n            if (existing.length > 0 && existing[0].image_data) {\n                const oldPath = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), 'public', existing[0].image_data);\n                if (fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(oldPath)) {\n                    fs__WEBPACK_IMPORTED_MODULE_1___default().unlinkSync(oldPath);\n                }\n            }\n            await _utils_db__WEBPACK_IMPORTED_MODULE_0__[\"default\"].query('DELETE FROM materiels_roulants WHERE id = ?', [\n                id\n            ]);\n            res.status(200).json({\n                message: 'Materiel roulant deleted successfully'\n            });\n        } catch (error) {\n            console.error('Error deleting materiel roulant:', error);\n            res.status(500).json({\n                error: 'Failed to delete materiel roulant'\n            });\n        }\n    } else {\n        res.setHeader('Allow', [\n            'PUT',\n            'DELETE'\n        ]);\n        res.status(405).end(`Method ${req.method} Not Allowed`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvbWF0ZXJpZWxzLXJvdWxhbnRzL1tpZF0uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQXFDO0FBQ2pCO0FBQ0k7QUFFVCxlQUFlRyxRQUFRQyxHQUFHLEVBQUVDLEdBQUc7SUFDNUMsTUFBTSxFQUFFQyxFQUFFLEVBQUUsR0FBR0YsSUFBSUcsS0FBSztJQUV4QixJQUFJSCxJQUFJSSxNQUFNLEtBQUssT0FBTztRQUN4QixNQUFNLEVBQUVDLElBQUksRUFBRUMsSUFBSSxFQUFFQyxTQUFTLEVBQUUsR0FBR1AsSUFBSVEsSUFBSTtRQUMxQyxJQUFJLENBQUNILFFBQVEsQ0FBQ0MsTUFBTTtZQUNsQixPQUFPTCxJQUFJUSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQTZCO1FBQ3BFO1FBRUEsSUFBSTtZQUNGLE1BQU0sQ0FBQ0MsU0FBUyxHQUFHLE1BQU1oQix1REFBVSxDQUFDLDBEQUEwRDtnQkFBQ007YUFBRztZQUNsRyxJQUFJVyxXQUFXRCxTQUFTRSxNQUFNLEdBQUcsSUFBSUYsUUFBUSxDQUFDLEVBQUUsQ0FBQ0csVUFBVSxHQUFHO1lBRTlELElBQUlSLFdBQVc7Z0JBQ2IsZ0NBQWdDO2dCQUNoQyxJQUFJO29CQUNBLE1BQU1TLFVBQVVsQixnREFBUyxDQUFDb0IsUUFBUUMsR0FBRyxJQUFJLFVBQVUsVUFBVTtvQkFDN0QsSUFBSSxDQUFDdEIsb0RBQWEsQ0FBQ21CLFVBQVU7d0JBQ3pCbkIsbURBQVksQ0FBQ21CLFNBQVM7NEJBQUVNLFdBQVc7d0JBQUs7b0JBQzVDO29CQUVBLE1BQU1DLFVBQVVoQixVQUFVaUIsS0FBSyxDQUFDO29CQUNoQyxJQUFJLENBQUNELFdBQVdBLFFBQVFULE1BQU0sS0FBSyxHQUFHO3dCQUNsQyxPQUFPYixJQUFJUSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDOzRCQUFFQyxPQUFPO3dCQUFxQjtvQkFDOUQ7b0JBRUEsTUFBTWMsY0FBY0MsT0FBT0MsSUFBSSxDQUFDSixPQUFPLENBQUMsRUFBRSxFQUFFO29CQUM1QyxNQUFNSyxnQkFBZ0JMLE9BQU8sQ0FBQyxFQUFFLENBQUNNLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJO29CQUNsRCxNQUFNQyxXQUFXLEdBQUd6QixLQUFLMEIsV0FBVyxHQUFHQyxPQUFPLENBQUMsUUFBUSxLQUFLLENBQUMsRUFBRUMsS0FBS0MsR0FBRyxHQUFHLENBQUMsRUFBRU4sZUFBZTtvQkFDNUYsTUFBTU8sV0FBV3JDLGdEQUFTLENBQUNrQixTQUFTYztvQkFFcENqQyx1REFBZ0IsQ0FBQ3NDLFVBQVVWO29CQUUzQix1Q0FBdUM7b0JBQ3ZDLElBQUlaLFVBQVU7d0JBQ1YsTUFBTXdCLFVBQVV2QyxnREFBUyxDQUFDb0IsUUFBUUMsR0FBRyxJQUFJLFVBQVVOO3dCQUNuRCxJQUFJaEIsb0RBQWEsQ0FBQ3dDLFVBQVU7NEJBQ3hCeEMsb0RBQWEsQ0FBQ3dDO3dCQUNsQjtvQkFDSjtvQkFFQXhCLFdBQVcsQ0FBQyx5QkFBeUIsRUFBRWlCLFVBQVU7Z0JBQ3JELEVBQUUsT0FBT25CLE9BQU87b0JBQ1o0QixRQUFRNUIsS0FBSyxDQUFDLHVCQUF1QkE7b0JBQ3JDLE9BQU9WLElBQUlRLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7d0JBQUVDLE9BQU87b0JBQXVCO2dCQUNoRTtZQUNGO1lBRUEsTUFBTWYsdURBQVUsQ0FDZCxxR0FDQTtnQkFBQ1M7Z0JBQU1DO2dCQUFNTztnQkFBVVg7YUFBRztZQUc1QixNQUFNLENBQUNzQyxZQUFZLEdBQUcsTUFBTTVDLHVEQUFVLENBQUMsaURBQWlEO2dCQUFDTTthQUFHO1lBQzVGRCxJQUFJUSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDOEIsV0FBVyxDQUFDLEVBQUU7UUFFckMsRUFBRSxPQUFPN0IsT0FBTztZQUNkNEIsUUFBUTVCLEtBQUssQ0FBQyxvQ0FBb0NBO1lBQ2xEVixJQUFJUSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQW9DO1FBQ3BFO0lBQ0YsT0FBTyxJQUFJWCxJQUFJSSxNQUFNLEtBQUssVUFBVTtRQUNsQyxJQUFJO1lBQ0YsTUFBTSxDQUFDUSxTQUFTLEdBQUcsTUFBTWhCLHVEQUFVLENBQUMsMERBQTBEO2dCQUFDTTthQUFHO1lBQ2xHLElBQUlVLFNBQVNFLE1BQU0sR0FBRyxLQUFLRixRQUFRLENBQUMsRUFBRSxDQUFDRyxVQUFVLEVBQUU7Z0JBQy9DLE1BQU1zQixVQUFVdkMsZ0RBQVMsQ0FBQ29CLFFBQVFDLEdBQUcsSUFBSSxVQUFVUCxRQUFRLENBQUMsRUFBRSxDQUFDRyxVQUFVO2dCQUN6RSxJQUFJbEIsb0RBQWEsQ0FBQ3dDLFVBQVU7b0JBQ3hCeEMsb0RBQWEsQ0FBQ3dDO2dCQUNsQjtZQUNKO1lBQ0EsTUFBTXpDLHVEQUFVLENBQUMsK0NBQStDO2dCQUFDTTthQUFHO1lBQ3BFRCxJQUFJUSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFK0IsU0FBUztZQUF3QztRQUMxRSxFQUFFLE9BQU85QixPQUFPO1lBQ2Q0QixRQUFRNUIsS0FBSyxDQUFDLG9DQUFvQ0E7WUFDbERWLElBQUlRLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBb0M7UUFDcEU7SUFDRixPQUFPO1FBQ0xWLElBQUl5QyxTQUFTLENBQUMsU0FBUztZQUFDO1lBQU87U0FBUztRQUN4Q3pDLElBQUlRLE1BQU0sQ0FBQyxLQUFLa0MsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFM0MsSUFBSUksTUFBTSxDQUFDLFlBQVksQ0FBQztJQUN4RDtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvbWF0aGlzZ3JpbGxvdC9Eb3dubG9hZHMvc25jZi10ZXItZ2VzdGlvbi0yLjAuMy9wYWdlcy9hcGkvbWF0ZXJpZWxzLXJvdWxhbnRzL1tpZF0uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBvb2wgZnJvbSAnLi4vLi4vLi4vdXRpbHMvZGInO1xuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XG4gIGNvbnN0IHsgaWQgfSA9IHJlcS5xdWVyeTtcblxuICBpZiAocmVxLm1ldGhvZCA9PT0gJ1BVVCcpIHtcbiAgICBjb25zdCB7IG5hbWUsIHR5cGUsIGltYWdlRGF0YSB9ID0gcmVxLmJvZHk7XG4gICAgaWYgKCFuYW1lIHx8ICF0eXBlKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ05hbWUgYW5kIHR5cGUgYXJlIHJlcXVpcmVkJyB9KTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgW2V4aXN0aW5nXSA9IGF3YWl0IHBvb2wucXVlcnkoJ1NFTEVDVCBpbWFnZV9kYXRhIEZST00gbWF0ZXJpZWxzX3JvdWxhbnRzIFdIRVJFIGlkID0gPycsIFtpZF0pO1xuICAgICAgbGV0IGltYWdlVXJsID0gZXhpc3RpbmcubGVuZ3RoID4gMCA/IGV4aXN0aW5nWzBdLmltYWdlX2RhdGEgOiBudWxsO1xuXG4gICAgICBpZiAoaW1hZ2VEYXRhKSB7XG4gICAgICAgIC8vIEEgbmV3IGltYWdlIGlzIGJlaW5nIHVwbG9hZGVkXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkaXJQYXRoID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdwdWJsaWMnLCAnaW1hZ2VzJywgJ21hdGVyaWVsLXJvdWxhbnQnKTtcbiAgICAgICAgICAgIGlmICghZnMuZXhpc3RzU3luYyhkaXJQYXRoKSkge1xuICAgICAgICAgICAgICAgIGZzLm1rZGlyU3luYyhkaXJQYXRoLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGltYWdlRGF0YS5tYXRjaCgvXmRhdGE6aW1hZ2VcXC8oW0EtWmEtei0rXFwvXSspO2Jhc2U2NCwoLispJC8pO1xuICAgICAgICAgICAgaWYgKCFtYXRjaGVzIHx8IG1hdGNoZXMubGVuZ3RoICE9PSAzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdJbnZhbGlkIGltYWdlIGRhdGEnIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBpbWFnZUJ1ZmZlciA9IEJ1ZmZlci5mcm9tKG1hdGNoZXNbMl0sICdiYXNlNjQnKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVFeHRlbnNpb24gPSBtYXRjaGVzWzFdLnNwbGl0KCcvJylbMV0gfHwgJ3BuZyc7XG4gICAgICAgICAgICBjb25zdCBmaWxlTmFtZSA9IGAke25hbWUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9cXHMrL2csICctJyl9LSR7RGF0ZS5ub3coKX0uJHtmaWxlRXh0ZW5zaW9ufWA7XG4gICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbihkaXJQYXRoLCBmaWxlTmFtZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGZzLndyaXRlRmlsZVN5bmMoZmlsZVBhdGgsIGltYWdlQnVmZmVyKTtcblxuICAgICAgICAgICAgLy8gSWYgdGhlcmUgd2FzIGFuIG9sZCBpbWFnZSwgZGVsZXRlIGl0XG4gICAgICAgICAgICBpZiAoaW1hZ2VVcmwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvbGRQYXRoID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdwdWJsaWMnLCBpbWFnZVVybCk7XG4gICAgICAgICAgICAgICAgaWYgKGZzLmV4aXN0c1N5bmMob2xkUGF0aCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZnMudW5saW5rU3luYyhvbGRQYXRoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGltYWdlVXJsID0gYC9pbWFnZXMvbWF0ZXJpZWwtcm91bGFudC8ke2ZpbGVOYW1lfWA7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzYXZpbmcgaW1hZ2U6JywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdGYWlsZWQgdG8gc2F2ZSBpbWFnZScgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgYXdhaXQgcG9vbC5xdWVyeShcbiAgICAgICAgJ1VQREFURSBtYXRlcmllbHNfcm91bGFudHMgU0VUIG5hbWUgPSA/LCB0eXBlID0gPywgaW1hZ2VfZGF0YSA9ID8sIHVwZGF0ZWRfYXQgPSBOT1coKSBXSEVSRSBpZCA9ID8nLFxuICAgICAgICBbbmFtZSwgdHlwZSwgaW1hZ2VVcmwsIGlkXVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgY29uc3QgW3VwZGF0ZWRSb3dzXSA9IGF3YWl0IHBvb2wucXVlcnkoJ1NFTEVDVCAqIEZST00gbWF0ZXJpZWxzX3JvdWxhbnRzIFdIRVJFIGlkID0gPycsIFtpZF0pO1xuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24odXBkYXRlZFJvd3NbMF0pO1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIG1hdGVyaWVsIHJvdWxhbnQ6JywgZXJyb3IpO1xuICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0ZhaWxlZCB0byB1cGRhdGUgbWF0ZXJpZWwgcm91bGFudCcgfSk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHJlcS5tZXRob2QgPT09ICdERUxFVEUnKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IFtleGlzdGluZ10gPSBhd2FpdCBwb29sLnF1ZXJ5KCdTRUxFQ1QgaW1hZ2VfZGF0YSBGUk9NIG1hdGVyaWVsc19yb3VsYW50cyBXSEVSRSBpZCA9ID8nLCBbaWRdKTtcbiAgICAgIGlmIChleGlzdGluZy5sZW5ndGggPiAwICYmIGV4aXN0aW5nWzBdLmltYWdlX2RhdGEpIHtcbiAgICAgICAgICBjb25zdCBvbGRQYXRoID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdwdWJsaWMnLCBleGlzdGluZ1swXS5pbWFnZV9kYXRhKTtcbiAgICAgICAgICBpZiAoZnMuZXhpc3RzU3luYyhvbGRQYXRoKSkge1xuICAgICAgICAgICAgICBmcy51bmxpbmtTeW5jKG9sZFBhdGgpO1xuICAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGF3YWl0IHBvb2wucXVlcnkoJ0RFTEVURSBGUk9NIG1hdGVyaWVsc19yb3VsYW50cyBXSEVSRSBpZCA9ID8nLCBbaWRdKTtcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ01hdGVyaWVsIHJvdWxhbnQgZGVsZXRlZCBzdWNjZXNzZnVsbHknIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBtYXRlcmllbCByb3VsYW50OicsIGVycm9yKTtcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdGYWlsZWQgdG8gZGVsZXRlIG1hdGVyaWVsIHJvdWxhbnQnIH0pO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICByZXMuc2V0SGVhZGVyKCdBbGxvdycsIFsnUFVUJywgJ0RFTEVURSddKTtcbiAgICByZXMuc3RhdHVzKDQwNSkuZW5kKGBNZXRob2QgJHtyZXEubWV0aG9kfSBOb3QgQWxsb3dlZGApO1xuICB9XG59XG4iXSwibmFtZXMiOlsicG9vbCIsImZzIiwicGF0aCIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJpZCIsInF1ZXJ5IiwibWV0aG9kIiwibmFtZSIsInR5cGUiLCJpbWFnZURhdGEiLCJib2R5Iiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiZXhpc3RpbmciLCJpbWFnZVVybCIsImxlbmd0aCIsImltYWdlX2RhdGEiLCJkaXJQYXRoIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJleGlzdHNTeW5jIiwibWtkaXJTeW5jIiwicmVjdXJzaXZlIiwibWF0Y2hlcyIsIm1hdGNoIiwiaW1hZ2VCdWZmZXIiLCJCdWZmZXIiLCJmcm9tIiwiZmlsZUV4dGVuc2lvbiIsInNwbGl0IiwiZmlsZU5hbWUiLCJ0b0xvd2VyQ2FzZSIsInJlcGxhY2UiLCJEYXRlIiwibm93IiwiZmlsZVBhdGgiLCJ3cml0ZUZpbGVTeW5jIiwib2xkUGF0aCIsInVubGlua1N5bmMiLCJjb25zb2xlIiwidXBkYXRlZFJvd3MiLCJtZXNzYWdlIiwic2V0SGVhZGVyIiwiZW5kIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/materiels-roulants/[id].js\n");

/***/ }),

/***/ "(api)/./utils/db.js":
/*!*********************!*\
  !*** ./utils/db.js ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"mysql2/promise\");\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mysql2_promise__WEBPACK_IMPORTED_MODULE_0__);\n\nconst pool = mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default().createPool({\n    host: process.env.MYSQL_HOST || '127.0.0.1',\n    port: process.env.MYSQL_PORT || 8889,\n    user: process.env.MYSQL_USER || 'root',\n    password: process.env.MYSQL_PASSWORD || 'root',\n    database: process.env.MYSQL_DATABASE || 'ter_new',\n    waitForConnections: true,\n    queueLimit: 0,\n    connectionLimit: 10\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (pool);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi91dGlscy9kYi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBbUM7QUFFbkMsTUFBTUMsT0FBT0QsZ0VBQWdCLENBQUM7SUFDNUJHLE1BQU1DLFFBQVFDLEdBQUcsQ0FBQ0MsVUFBVSxJQUFJO0lBQ2hDQyxNQUFNSCxRQUFRQyxHQUFHLENBQUNHLFVBQVUsSUFBSTtJQUNoQ0MsTUFBTUwsUUFBUUMsR0FBRyxDQUFDSyxVQUFVLElBQUk7SUFDaENDLFVBQVVQLFFBQVFDLEdBQUcsQ0FBQ08sY0FBYyxJQUFJO0lBQ3hDQyxVQUFVVCxRQUFRQyxHQUFHLENBQUNTLGNBQWMsSUFBSTtJQUN4Q0Msb0JBQW9CO0lBQ3BCQyxZQUFZO0lBQ1pDLGlCQUFpQjtBQUNuQjtBQUdBLGlFQUFlaEIsSUFBSUEsRUFBQyIsInNvdXJjZXMiOlsiL1VzZXJzL21hdGhpc2dyaWxsb3QvRG93bmxvYWRzL3NuY2YtdGVyLWdlc3Rpb24tMi4wLjMvdXRpbHMvZGIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG15c3FsIGZyb20gJ215c3FsMi9wcm9taXNlJztcblxuY29uc3QgcG9vbCA9IG15c3FsLmNyZWF0ZVBvb2woe1xuICBob3N0OiBwcm9jZXNzLmVudi5NWVNRTF9IT1NUIHx8ICcxMjcuMC4wLjEnLFxuICBwb3J0OiBwcm9jZXNzLmVudi5NWVNRTF9QT1JUIHx8IDg4ODksXG4gIHVzZXI6IHByb2Nlc3MuZW52Lk1ZU1FMX1VTRVIgfHwgJ3Jvb3QnLFxuICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuTVlTUUxfUEFTU1dPUkQgfHwgJ3Jvb3QnLFxuICBkYXRhYmFzZTogcHJvY2Vzcy5lbnYuTVlTUUxfREFUQUJBU0UgfHwgJ3Rlcl9uZXcnLFxuICB3YWl0Rm9yQ29ubmVjdGlvbnM6IHRydWUsXG4gIHF1ZXVlTGltaXQ6IDAsXG4gIGNvbm5lY3Rpb25MaW1pdDogMTAsXG59KTtcblxuXG5leHBvcnQgZGVmYXVsdCBwb29sOyJdLCJuYW1lcyI6WyJteXNxbCIsInBvb2wiLCJjcmVhdGVQb29sIiwiaG9zdCIsInByb2Nlc3MiLCJlbnYiLCJNWVNRTF9IT1NUIiwicG9ydCIsIk1ZU1FMX1BPUlQiLCJ1c2VyIiwiTVlTUUxfVVNFUiIsInBhc3N3b3JkIiwiTVlTUUxfUEFTU1dPUkQiLCJkYXRhYmFzZSIsIk1ZU1FMX0RBVEFCQVNFIiwid2FpdEZvckNvbm5lY3Rpb25zIiwicXVldWVMaW1pdCIsImNvbm5lY3Rpb25MaW1pdCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./utils/db.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmateriels-roulants%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fmateriels-roulants%2F%5Bid%5D.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();